 # سیستم آرشیو آگهی‌ها

## بررسی کلی

این سیستم به طور خودکار آگهی‌هایی که بیش از یک ماه از ثبت آنها گذشته را آرشیو می‌کند و قابلیت تمدید برای آنها فراهم می‌آورد.

## ویژگی‌ها

### 1. آرشیو خودکار
- آگهی‌هایی که بیش از 30 روز از ثبت آنها گذشته باشد به طور خودکار آرشیو می‌شوند
- آگهی‌های آرشیو شده در جستجو و نمایش عمومی نمایش داده نمی‌شوند

### 2. هشدار قبل از آرشیو
- 5 روز قبل از آرشیو شدن، به کاربر هشدار داده می‌شود
- کاربر می‌تواند آگهی خود را تمدید کند تا از آرشیو شدن جلوگیری کند

### 3. قابلیت تمدید
- کاربران می‌توانند آگهی‌های آرشیو شده یا نزدیک به آرشیو را تمدید کنند
- تمدید آگهی آن را دوباره فعال می‌کند

### 4. مدیریت ادمین
- ادمین‌ها می‌توانند آگهی‌های نیازمند آرشیو را مشاهده کنند
- امکان آرشیو گروهی آگهی‌ها
- آمار آگهی‌های فعال، آرشیو شده و نیازمند آرشیو

## نحوه کارکرد

### برای کاربران عادی:
1. در صفحه "آگهی‌های من" هشدارهای آرشیو نمایش داده می‌شود
2. کاربران می‌توانند آگهی‌های خود را بر اساس وضعیت فیلتر کنند
3. دکمه تمدید برای آگهی‌های نزدیک به آرشیو یا آرشیو شده نمایش داده می‌شود

### برای ادمین‌ها:
1. در پنل مدیریت، آگهی‌های نیازمند آرشیو نمایش داده می‌شود
2. امکان آرشیو تکی یا گروهی آگهی‌ها
3. مشاهده آمار کلی سیستم

## فایل‌های مرتبط

### کامپوننت‌ها:
- `src/components/ui/archive-warning.tsx` - کامپوننت هشدار آرشیو
- `src/pages/MyAdsPage.tsx` - صفحه آگهی‌های کاربر
- `src/pages/AdminDashboard.tsx` - پنل مدیریت ادمین

### هوک‌ها:
- `src/hooks/useAds.ts` - توابع مدیریت آرشیو

### دیتابیس:
- `supabase/migrations/001_add_archived_status.sql` - مایگریشن دیتابیس

## توابع مهم

### بررسی آرشیو:
```typescript
shouldArchiveAd(createdAt: string): boolean
```

### بررسی هشدار:
```typescript
needsArchiveWarning(createdAt: string): boolean
```

### آرشیو کردن:
```typescript
archiveAd(adId: string): Promise<void>
```

### تمدید:
```typescript
renewAd(adId: string): Promise<void>
```

## وضعیت‌های آگهی

- `active` - فعال و قابل مشاهده
- `archived` - آرشیو شده و غیرقابل مشاهده
- `pending` - در انتظار تایید
- `rejected` - رد شده
- `expired` - منقضی شده

## نکات مهم

1. آگهی‌های آرشیو شده در جستجو و نمایش عمومی نمایش داده نمی‌شوند
2. فقط آگهی‌های فعال در صفحه اصلی نمایش داده می‌شوند
3. کاربران می‌توانند آگهی‌های آرشیو شده خود را مشاهده و تمدید کنند
4. سیستم هشدار 5 روز قبل از آرشیو فعال می‌شود
5. ادمین‌ها می‌توانند آگهی‌ها را به صورت دستی آرشیو کنند 